# Implementation Plan

- [x] 1. プロジェクト基盤とコア型定義の設定
  - /tone ディレクトリにNext.js + TypeScriptプロジェクトを初期化
  - 基本的なプロジェクト構造（components, types, utils, workers）を作成
  - 画像処理に必要な型定義（ProcessableImage, ProcessedImage, FilterConfig, FilterPreset）を実装
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 6.1, 6.2_

- [x] 2. ファイルアップロード機能の実装
  - [x] 2.1 基本的なファイルアップロードコンポーネントの作成
    - ImageUploaderコンポーネントを実装（ファイル選択、ドラッグ&ドロップ対応）
    - JPG, PNG, HEIC形式のファイル検証機能を実装
    - 複数ファイル同時選択機能を実装
    - ファイルアップロード機能のユニットテストを作成
    - _Requirements: 1.1, 1.2, 1.3_

  - [x] 2.2 HEIC形式対応とプレビュー機能の実装
    - heic2anyライブラリを統合してHEIC→JPEG変換機能を実装
    - アップロードされた画像のプレビュー表示機能を実装
    - 画像メタデータ抽出機能を実装
    - HEIC変換とプレビュー機能のテストを作成
    - _Requirements: 1.1, 1.4_

- [x] 3. プリセット選択機能の実装
  - [x] 3.1 プリセット定義とセレクターコンポーネントの作成
    - 4つのフィルタープリセット（商品をくっきり、明るくクリア、暖かみ、クール）の設定値を定義
    - PresetSelectorコンポーネントを実装（プリセット選択UI）
    - プリセット選択状態の管理機能を実装
    - プリセット選択機能のテストを作成
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

  - [x] 3.2 プリセットプレビュー機能の実装
    - 選択されたプリセットの効果をリアルタイムでプレビューする機能を実装
    - プリセット説明とアイコン表示機能を実装
    - プリセットプレビューのテストを作成
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 4. 画像処理エンジンの実装
  - [x] 4.1 Canvas APIベースのフィルター処理機能の作成
    - Canvas APIを使用した基本的な画像フィルター関数（brightness, contrast, saturation, hue, sharpness, warmth）を実装
    - FilterConfigに基づいて画像にフィルターを適用する処理を実装
    - 各フィルター関数のユニットテストを作成
    - _Requirements: 2.2, 2.3, 2.4, 2.5_

  - [x] 4.2 Web Worker による並列処理機能の実装
    - 画像処理用のWeb Workerを実装
    - メインスレッドとWorker間の通信機能を実装
    - 複数画像の並列処理機能を実装
    - Web Worker処理のテストを作成
    - _Requirements: 3.1, 3.2, 8.1, 8.2_

- [x] 5. 一括処理とプログレス表示の実装
  - [x] 5.1 一括処理機能とプログレス表示の作成
    - ImageProcessorコンポーネントを実装（一括処理制御）
    - 処理進行状況の表示機能を実装
    - エラーハンドリング機能（個別画像の処理失敗時の継続処理）を実装
    - 一括処理機能のテストを作成
    - _Requirements: 3.1, 3.2, 3.3, 8.3_

  - [x] 5.2 処理結果の管理と状態更新機能の実装
    - 処理済み画像の状態管理機能を実装
    - 処理完了時の結果データ生成機能を実装
    - 処理結果管理のテストを作成
    - _Requirements: 3.1, 3.4_

- [x] 6. 結果表示とプレビュー機能の実装
  - [x] 6.1 Before/After比較表示機能の作成
    - ResultViewerコンポーネントを実装（処理前後の比較表示）
    - 画像の拡大プレビュー機能を実装
    - 複数画像の一覧表示機能を実装
    - 比較表示機能のテストを作成
    - _Requirements: 4.1, 4.2, 4.3, 4.4_

  - [x] 6.2 プレビュー操作とナビゲーション機能の実装
    - 画像間のナビゲーション機能を実装
    - 適用されたプリセット名の表示機能を実装
    - プレビュー操作機能のテストを作成
    - _Requirements: 4.1, 4.2, 4.3, 4.4_

- [x] 7. ダウンロード機能の実装
  - [x] 7.1 個別ダウンロード機能の作成
    - 個別画像のダウンロード機能を実装
    - 元の画像品質を維持したファイル生成機能を実装
    - 個別ダウンロード機能のテストを作成
    - _Requirements: 5.1, 5.3_

  - [x] 7.2 一括ダウンロード（ZIP）機能の実装
    - JSZipライブラリを使用したZIPファイル生成機能を実装
    - 分かりやすいファイル名の自動生成機能を実装
    - ZIP一括ダウンロード機能のテストを作成
    - _Requirements: 5.2, 5.4_

- [x] 8. UI/UXとワークフロー統合の実装
  - [x] 8.1 3ステップワークフローUIの作成
    - メインアプリケーションコンポーネントを実装（全体のワークフロー制御）
    - ステップ表示とナビゲーション機能を実装
    - 現在ステップのハイライト表示機能を実装
    - ワークフローUIのテストを作成
    - _Requirements: 6.1, 6.2, 6.3_

  - [x] 8.2 レスポンシブデザインとアクセシビリティの実装
    - モバイル対応のレスポンシブデザインを実装
    - キーボードナビゲーション対応を実装
    - スクリーンリーダー対応（ARIA属性）を実装
    - アクセシビリティのテストを作成
    - _Requirements: 6.4_

- [x] 9. QuickToolsブランド統合とスタイリング
  - [x] 9.1 QuickToolsデザインシステムの適用
    - QuickToolsファミリーと統一されたカラーパレットとタイポグラフィを適用
    - ブランドロゴとナビゲーションリンクを実装
    - 統一されたコンポーネントスタイルを実装
    - ブランド統合のビジュアルテストを作成
    - _Requirements: 7.1, 7.2, 7.3, 7.4_

  - [x] 9.2 最終的なUI調整とポリッシュ
    - アニメーションとトランジション効果を実装
    - ローディング状態とフィードバック表示を改善
    - 全体的なUI/UXの最終調整を実施
    - UI統合テストを作成
    - _Requirements: 6.1, 6.2, 6.3, 7.1_

- [x] 10. パフォーマンス最適化とエラーハンドリング
  - [x] 10.1 パフォーマンス最適化の実装
    - 大容量画像の処理最適化機能を実装
    - メモリ管理とクリーンアップ機能を実装
    - 処理時間の最適化を実施
    - パフォーマンステストを作成
    - _Requirements: 8.1, 8.2, 8.4_

  - [x] 10.2 包括的なエラーハンドリングの実装
    - ファイル形式エラーの処理機能を実装
    - 処理エラーの回復機能を実装
    - ブラウザ互換性チェック機能を実装
    - エラーハンドリングのテストを作成
    - _Requirements: 3.3, 8.4_

- [x] 11. 統合テストとE2Eテストの実装
  - [x] 11.1 統合テストスイートの作成
    - コンポーネント間連携の統合テストを作成
    - ファイル処理パイプライン全体のテストを作成
    - 統合テストの実行環境を設定
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1-2.6, 3.1-3.4, 4.1-4.4, 5.1-5.4_

  - [x] 11.2 E2Eテストとユーザビリティテストの実装
    - Playwrightを使用したE2Eテストを作成
    - 3ステップワークフローの完全なテストシナリオを実装
    - ブラウザ互換性テストを実施
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 7.1-7.4, 8.1-8.4_

- [x] 12. 型エラーとインポートエラーの修正






  - [x] 12.1 Notificationコンポーネントのインポートエラー修正


    - EasyToneApp.tsxでのNotificationコンポーネントのインポート方法を修正
    - デフォルトエクスポートとして正しくインポートするよう変更
    - _Requirements: 6.1, 6.2_

  - [x] 12.2 型定義の整合性修正


    - ProcessableImageとImageMetadataの型定義を統一
    - EasyToneApp.tsxでの型エラーを修正（metadata構造の不整合）
    - PresetSelectorWithPreviewのprops型エラーを修正
    - _Requirements: 1.1, 1.2, 2.1_

  - [x] 12.3 プリセット選択ロジックの修正


    - getPresetByIdを使用してプリセットオブジェクトを正しく取得
    - プリセット選択時の型安全性を確保
    - _Requirements: 2.1, 2.2_

- [-] 13. アプリケーション統合の完成


  - [x] 13.1 ワークフロー統合の最終調整


    - 各ステップ間のデータフローを確認・修正
    - 処理開始トリガーの実装を完成
    - エラー状態からの回復フローを実装
    - _Requirements: 6.1, 6.2, 6.3_


  - [ ] 13.2 ビルドエラーの解決とデプロイ準備

    - 全ての型エラーとコンパイルエラーを修正
    - プロダクションビルドが成功することを確認
    - 最終的な動作テストを実施
    - _Requirements: 8.1, 8.2, 8.4_

- [ ] 14. プロダクション公開設定
  - [ ] 14.1 Next.js設定の最適化
    - next.config.tsでbasePath: '/tone'を設定
    - 静的アセットのパス設定を調整
    - プロダクション用の最適化設定を追加
    - _Requirements: 8.1, 8.4_

  - [ ] 14.2 SEOとメタデータの最適化
    - layout.tsxのメタデータを本番URL用に更新
    - OGタグとTwitterカードの設定を完成
    - サイトマップとrobots.txtの設定
    - _Requirements: 7.1, 7.2_

  - [ ] 14.3 QuickToolsブランド統合の最終調整
    - ヘッダー・フッターのリンクを本番URL用に更新
    - 他のQuickToolsサービスとの連携設定
    - ブランド統一性の最終確認
    - _Requirements: 7.1, 7.2, 7.3, 7.4_